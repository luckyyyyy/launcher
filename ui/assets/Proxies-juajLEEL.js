import{c as e,H as xe,i as n,A as p,F as A,b as x,d as f,aq as be,ar as se,S as R,t as O,g as W,D as pe,h as le,q as $e,T as _e,_ as we,a1 as ye,k as Ce,as as ie,M as Pe,Q as ae,e as Se}from"./vendor-8-YBH5HO.js";import{u as K,J as Te,K as Le,N as Ee,O as Ne,P as Ie,Q as De,R as Me,S as ke,U as Oe,V as H,W as Ae,X as Ue,Y as Fe,Z as je,_ as Z,$ as ve,a0 as G,a1 as J,M as Be,a2 as N,a3 as he,a4 as ee,c as Re,B as X,a5 as He,a6 as ce,a7 as oe,a8 as de}from"./index-CzPGTTWR.js";import{f as Ye}from"./global-BXG-JOT0.js";import{C as k}from"./ConfigTitle-CI5ujqvH.js";var Qe=f('<div class="flex flex-col gap-4"><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><input type=number class="input input-bordered w-full"></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><select class="select select-bordered w-full"></select></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><select class="select select-bordered w-full">'),Xe=f('<option class="flex items-center gap-2">'),qe=f("<option>");const ze=l=>{const[r]=K();return e(Be,{ref:t=>{var i;return(i=l.ref)==null?void 0:i.call(l,t)},get icon(){return e(xe,{size:24})},get title(){return r("proxiesSettings")},get children(){var t=Qe(),i=t.firstChild,a=i.firstChild,u=a.firstChild,g=i.nextSibling,w=g.firstChild,o=g.nextSibling,I=o.firstChild,b=o.nextSibling,C=b.firstChild,P=b.nextSibling,$=P.firstChild,v=P.nextSibling,S=v.firstChild,T=S.firstChild,y=v.nextSibling,L=y.firstChild,q=L.firstChild,z=y.nextSibling,j=z.firstChild;return n(i,e(k,{withDivider:!0,get children(){return r("autoCloseConns")}}),a),u.addEventListener("change",d=>Te(d.target.checked)),n(g,e(k,{withDivider:!0,get children(){return r("urlForLatencyTest")}}),w),w.addEventListener("change",d=>Le(d.target.value)),n(o,e(k,{withDivider:!0,get children(){return[p(()=>r("latencyTestTimeoutDuration"))," (",p(()=>r("ms")),")"]}}),I),I.addEventListener("change",d=>Ee(Number(d.target.value))),n(b,e(k,{withDivider:!0,get children(){return r("urlForIPv6SupportTest")}}),C),C.addEventListener("change",d=>{var m;return Ne((m=d.target.value)==null?void 0:m.trim())}),n(P,e(k,{withDivider:!0,get children(){return r("proxiesSorting")}}),$),$.addEventListener("change",d=>Ie(d.target.value)),n($,e(A,{get each(){return Object.values(De)},children:d=>(()=>{var m=Xe();return m.value=d,n(m,()=>r(d)),m})()})),n(v,e(k,{withDivider:!0,get children(){return r("hideUnAvailableProxies")}}),S),T.addEventListener("change",d=>Me(d.target.checked)),n(y,e(k,{withDivider:!0,get children(){return r("renderInTwoColumns")}}),L),q.addEventListener("change",d=>ke(d.target.checked)),n(z,e(k,{withDivider:!0,get children(){return r("proxiesPreviewType")}}),j),j.addEventListener("change",d=>Oe(d.target.value)),n(j,e(A,{get each(){return Object.values(H)},children:d=>(()=>{var m=qe();return m.value=d,n(m,()=>r(d)),m})()})),x(()=>u.checked=Ae()),x(()=>w.value=Ue()),x(()=>I.value=Fe()),x(()=>C.value=je()),x(()=>$.value=Z()),x(()=>T.checked=ve()),x(()=>q.checked=G()),x(()=>j.value=J()),t}})},ue=l=>{const r=()=>J()===H.OFF,t=p(()=>l.proxyNameList.length<=10),i=p(()=>{const u=J();return u===H.BAR||u===H.Auto&&!t()}),a=p(()=>{const u=J();return u===H.DOTS||u===H.Auto&&t()});return e(R,{get when(){return!r()},get children(){return e(be,{get children(){return[e(se,{get when(){return i()},get children(){return e(We,{get proxyNameList(){return l.proxyNameList},get now(){return l.now}})}}),e(se,{get when(){return a()},get children(){return e(Ge,{get proxyNameList(){return l.proxyNameList},get now(){return l.now}})}})]}})}})};var Ve=f('<div class="flex items-center gap-2 py-2"><div class="my-2 flex flex-1 items-center justify-center overflow-hidden rounded-2xl [&amp;>*]:h-2"><div class=bg-success></div><div class=bg-warning></div><div class=bg-error></div><div class=bg-neutral>');const We=l=>{const{latencyMap:r}=ee(),t=p(()=>l.proxyNameList.map(o=>r()[o])),i=p(()=>t().length),a=p(()=>t().filter(o=>o>N().NOT_CONNECTED&&o<=N().MEDIUM).length),u=p(()=>t().filter(o=>o>N().MEDIUM&&o<=N().HIGH).length),g=p(()=>t().filter(o=>o>N().HIGH).length),w=p(()=>t().filter(o=>o===N().NOT_CONNECTED).length);return(()=>{var o=Ve(),I=o.firstChild,b=I.firstChild,C=b.nextSibling,P=C.nextSibling,$=P.nextSibling;return n(o,e(he,{get name(){return l.now}}),null),x(v=>{var S=`${a()*100/i()}%`,T=`${u()*100/i()}%`,y=`${g()*100/i()}%`,L=`${w()*100/i()}%`;return S!==v.e&&((v.e=S)!=null?b.style.setProperty("width",S):b.style.removeProperty("width")),T!==v.t&&((v.t=T)!=null?C.style.setProperty("width",T):C.style.removeProperty("width")),y!==v.a&&((v.a=y)!=null?P.style.setProperty("width",y):P.style.removeProperty("width")),L!==v.o&&((v.o=L)!=null?$.style.setProperty("width",L):$.style.removeProperty("width")),v},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()};var Je=f("<div>"),Ke=f('<div class="flex items-center gap-2 py-2"><div class="flex flex-1 flex-wrap items-center gap-1">');const Ze=l=>{let r=l.selected?"bg-white border-4 border-success":"bg-success";return typeof l.latency!="number"||l.latency===N().NOT_CONNECTED?r=l.selected?"bg-white border-4 border-neutral":"bg-neutral":l.latency>N().HIGH?r=l.selected?"bg-white border-4 border-error":"bg-error":l.latency>N().MEDIUM&&(r=l.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{var t=Je();return x(i=>{var a=O("h-4 w-4 rounded-full",r),u=l.name;return a!==i.e&&W(t,i.e=a),u!==i.t&&pe(t,"title",i.t=u),i},{e:void 0,t:void 0}),t})()},Ge=l=>{const{latencyMap:r}=ee();return(()=>{var t=Ke(),i=t.firstChild;return n(i,e(A,{get each(){return l.proxyNameList.map(a=>[a,r()[a]])},children:([a,u])=>{const g=l.now===a;return e(Ze,{name:a,latency:u,selected:g})}})),n(t,e(he,{get name(){return l.now}}),null),t})()};var et=f("<progress class=progress max=100>"),tt=f('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),nt=f('<div class="text-sm text-slate-500">: ');const rt=l=>{const{Download:r=0,Upload:t=0,Total:i=0,Expire:a=0}=l,u=le(i,{units:"iec"}),g=le(r+t,{units:"iec"}),w=$e.toFinite(((r+t)/i*100).toFixed(2));return{total:u,used:g,percentage:w,expirePrefix:()=>{const[b]=K();return b("expire")},expireStr:()=>{const[b]=K();return a===0?b("noExpire"):_e(a*1e3).format("YYYY-MM-DD")}}},st=l=>{if(!l.subscriptionInfo)return;const r=rt(l.subscriptionInfo);return[(()=>{var t=et();return x(()=>t.value=r.percentage),t})(),(()=>{var t=tt(),i=t.firstChild,a=i.nextSibling,u=a.nextSibling,g=u.nextSibling;return g.nextSibling,n(t,()=>`${r.used}`,i),n(t,()=>`${r.total}`,a),n(t,()=>r.percentage,g),t})(),(()=>{var t=nt(),i=t.firstChild;return n(t,()=>r.expirePrefix(),i),n(t,()=>r.expireStr(),null),t})()]};var ge=f("<div>"),lt=f('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class=ml-auto></div></div><div class="flex-1 overflow-y-auto">'),it=f('<button><span></span><div class="badge badge-sm">'),at=f('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div><span class="text-xs text-slate-500"> '),ct=f('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div class="flex items-center gap-2">'),ot=f('<div class="text-sm text-slate-500"> :: <!> ');const ht=()=>{const l=we();if(!Re())return l("/setup",{replace:!0}),null;let r;const[t]=K(),{fetchProxies:i,proxies:a,selectProxyInGroup:u,latencyMap:g,proxyGroupNames:w,proxyProviders:o,updateProviderByProviderName:I,updateAllProvider:b,proxyGroupLatencyTest:C,proxyProviderLatencyTest:P,collapsedMap:$,setCollapsedMap:v,proxyGroupLatencyTestingMap:S,proxyProviderLatencyTestingMap:T,isAllProviderUpdating:y,updatingMap:L}=ee();ye(i);const q=async(_,E)=>{_.stopPropagation(),C(E)},z=(_,E)=>{_.stopPropagation(),P(E)},j=(_,E)=>{_.stopPropagation(),I(E)},d=async _=>{_.stopPropagation(),b()},[m,me]=Ce("proxies"),fe=()=>[{type:"proxies",name:t("proxies"),count:a().length},{type:"proxyProviders",name:t("proxyProviders"),count:o().length}];return(()=>{var _=lt(),E=_.firstChild,te=E.firstChild,ne=te.nextSibling,re=E.nextSibling;return n(te,e(A,{get each(){return fe()},children:h=>(()=>{var s=it(),D=s.firstChild,Y=D.nextSibling;return s.$$click=()=>me(h.type),n(D,()=>h.name),n(Y,()=>h.count),x(()=>W(s,O(m()===h.type&&"tab-active","tab-sm sm:tab-md tab gap-2 px-2"))),s})()})),n(E,e(R,{get when(){return m()==="proxyProviders"},get children(){return e(X,{class:"btn btn-circle btn-sm",get disabled(){return y()},onClick:h=>d(h),get icon(){return e(ie,{get class(){return O(y()&&"animate-spin text-success")}})}})}}),ne),n(ne,e(X,{class:"btn-circle btn-sm sm:btn-md",onClick:()=>r==null?void 0:r.showModal(),get icon(){return e(Pe,{})}})),n(re,e(R,{get when(){return m()==="proxies"},get children(){var h=ge();return n(h,e(A,{get each(){return a()},children:s=>{const D=p(()=>He(ce(s.all??[],g(),Z(),w()),g(),w(),ve())),Y=[(()=>{var c=at(),U=c.firstChild,M=U.firstChild,V=M.nextSibling,B=V.nextSibling,Q=B.firstChild;return n(M,()=>s.name),n(V,()=>{var F;return(F=s.all)==null?void 0:F.length}),n(B,()=>s.type,Q),n(B,()=>{var F;return((F=s.now)==null?void 0:F.length)>0&&` :: ${s.now}`},null),n(c,e(X,{class:"btn-circle btn-sm",get disabled(){return S()[s.name]},onClick:F=>q(F,s.name),get icon(){return e(ae,{get class(){return O(S()[s.name]&&"animate-pulse text-success")}})}}),null),c})(),e(R,{get when(){return!$()[s.name]},get children(){return e(ue,{get proxyNameList(){return D()},get now(){return s.now}})}})];return e(oe,{get isOpen(){return $()[s.name]},title:Y,onCollapse:c=>v(s.name,c),get children(){return e(A,{get each(){return D()},children:c=>e(de,{proxyName:c,get isSelected(){return s.now===c},onClick:()=>void u(s,c)})})}})}})),x(()=>W(h,O("grid grid-cols-1 place-items-start gap-2",G()?"sm:grid-cols-2":"sm:grid-cols-1"))),h}}),null),n(re,e(R,{get when(){return m()==="proxyProviders"},get children(){var h=ge();return n(h,e(A,{get each(){return o()},children:s=>{const D=p(()=>ce(s.proxies.map(c=>c.name)??[],g(),Z(),void 0)),Y=[(()=>{var c=ct(),U=c.firstChild,M=U.firstChild,V=M.nextSibling,B=U.nextSibling;return n(M,()=>s.name),n(V,()=>s.proxies.length),n(B,e(X,{class:"btn btn-circle btn-sm",get disabled(){return L()[s.name]},onClick:Q=>j(Q,s.name),get icon(){return e(ie,{get class(){return O(L()[s.name]&&"animate-spin text-success")}})}}),null),n(B,e(X,{class:"btn btn-circle btn-sm",get disabled(){return T()[s.name]},onClick:Q=>z(Q,s.name),get icon(){return e(ae,{get class(){return O(T()[s.name]&&"animate-pulse text-success")}})}}),null),c})(),e(st,{get subscriptionInfo(){return s.subscriptionInfo}}),(()=>{var c=ot(),U=c.firstChild,M=U.nextSibling;return M.nextSibling,n(c,()=>s.vehicleType,U),n(c,()=>t("updated"),M),n(c,()=>Ye(s.updatedAt),null),c})(),e(R,{get when(){return!$()[s.name]},get children(){return e(ue,{get proxyNameList(){return D()}})}})];return e(oe,{get isOpen(){return $()[s.name]},title:Y,onCollapse:c=>v(s.name,c),get children(){return e(A,{get each(){return D()},children:c=>e(de,{proxyName:c})})}})}})),x(()=>W(h,O("grid grid-cols-1 place-items-start gap-2",G()?"sm:grid-cols-2":"sm:grid-cols-1"))),h}}),null),n(_,e(ze,{ref:h=>r=h}),null),_})()};Se(["click"]);export{ht as default};
